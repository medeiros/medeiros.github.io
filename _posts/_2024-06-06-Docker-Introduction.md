---
layout: post
title: "Docker Introduction"
description: >
  Introduction of Docker: basic steps to understand, configure and run Docker 
categories: linux
tags: [docker, containerization, cloud]
comments: true
image: /assets/img/blog/arch/archlinux.png
---
> This page explain the basic of Docker architecture and configuration. It 
aims to reinforce knowledge of this technology.
{:.lead}

- Table of Contents
{:toc}

## Docker Configuration

### Docker Login  

#### Creating an account

The first step is go to Docker Hub (https://hub.docker.com) and create an account.

#### Connecting to Docker Hub 

Then, in your local terminal, execute the following command:

```
docker login
```

You'll be prompted to inform the Docker Hub username and password.

After that, the following warning will appear:

```
WARNING! Your password will be stored unencrypted in /home/daniel/.docker
/config.json.
Configure a credential helper to remove this warning. See
https://docs.docker.com/engine/reference/commandline/login/#credentials-s
tore
```

So lets improve credencial's security by adding `pass` along with `gpg` 
(which will be required by pass).

#### Installing pass and gpg

The first step is to install `pass` locally (to save docker password).
So, execute the following command:

```
sudo pacman -S pass gnupg
```

#### Configuring GPG

Execute as following:

```
gpg --expert --full-gen-key
```

- Then select the option 9 (to create an ECC - Elliptic Curve Criptography).
- Next, choose option 1 (to create ed25519 keys).
- Next, choose 2y (so the key will be valid for two years) and confirm.
- Now, provide identification for the key: your full name and email address. 
This information is important because it will be included in the key. The 
email address is considered an unique identifier.
- After that, a passphrase will be asked to protect your private key. Inform 
it - and save this passphrase (that will be required if you want to recover
your private key).

After that, GPG will generate your keys in the `~/.gnupg` directory, with 
the following three files:

- `./openpgp-revocs.d/<your key>.rev`: this is the public key
- `./private-keys-v1.d/<first file>.rev`: this is one of the files that 
composesyour private key
- `./private-keys-v1.d/<second file>.rev`: this is the second file that 
composes your private key

The key that will be used by pass is the public key. It was to be exported 
before can be used. The following command do this:

```
$ ~/.gnupg/openpgp-revocs.d> gpg --armor --export 
  <your email address> > pubkey.asc
```

#### Configuring pass with gpg

Now that we have the public GPG key, lets get back and configure pass.

```
$ ~> pass init ~/.gnupg/openpgp-revocs.d/pubkey.asc

Password store initialized for .gnupg/openpgp-revocs.d/pubkey.asc
```

The directory `~/.password-store` was created, containing the 
`gpg_id` file. This file has only one line - a path to the `pubkey.asc` 
file, previously generated by gpg.

#### Saving Docker Hub credentials in pass

TODO: continuar daqui

#### Going back to Docker Login


Now we can improve the security of Docker login, by using a password 
manager (`pass`) to store its credentials [^1].

Edit the Docker config file and make sure that is set as below:

```
nvim ~/.docker/config.json

{
  "credsStore": "pass"
}
```



## Conclusions

This article is aimed to reinforce knowledge of Docker fundamentals. 

## References

- [A Practical Guide to GPG Part 1: Generate Your Public/Private Key Pair](https://www.linuxbabe.com/security/a-practical-guide-to-gpg-part-1-generate-your-keypair)

[^1]: [Docker login: credentials store](https://docs.docker.com/reference/cli/docker/login/#credentials-store)
